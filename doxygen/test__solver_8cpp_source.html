<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NEURON: /home/runner/work/nrn/nrn/test/coreneuron/unit/solver/test_solver.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NEURON
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('test__solver_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">test_solver.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="test__solver_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"># =============================================================================</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"># Copyright (c) 2022 Blue Brain Project/EPFL</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"># See top-level LICENSE file for details.</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"># =============================================================================.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="corenrn__parameters_8hpp.html">coreneuron/apps/corenrn_parameters.hpp</a>&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="nrn__acc__manager_8hpp.html">coreneuron/gpu/nrn_acc_manager.hpp</a>&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cellorder_8hpp.html">coreneuron/permute/cellorder.hpp</a>&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="node__permute_8h.html">coreneuron/permute/node_permute.h</a>&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="multicore_8hpp.html">coreneuron/sim/multicore.hpp</a>&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno"><a class="line" href="test__solver_8cpp.html#a656eb5868e824d59f489f910db438420">   14</a></span>&#160;<span class="preprocessor">#define CATCH_CONFIG_MAIN</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;catch2/catch.hpp&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;functional&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;random&gt;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;utility&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacecoreneuron.html">coreneuron</a>;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="struct_solver_data.html">   26</a></span>&#160;<span class="keyword">struct </span><a class="code" href="struct_solver_data.html">SolverData</a> {</div>
<div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="struct_solver_data.html#ad56edaf3ee9e0f9c7d951c5318d358b4">   27</a></span>&#160;    std::vector&lt;double&gt; d, <a class="code" href="struct_solver_data.html#ad56edaf3ee9e0f9c7d951c5318d358b4">rhs</a>;</div>
<div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="struct_solver_data.html#ab78f9ca29611b33465bbbb1fe682dd64">   28</a></span>&#160;    std::vector&lt;int&gt; <a class="code" href="struct_solver_data.html#ab78f9ca29611b33465bbbb1fe682dd64">parent_index</a>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;};</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="test__solver_8cpp.html#a11805bf0159f4f05712c08e5b1eb580d">   31</a></span>&#160;constexpr <span class="keyword">auto</span> <a class="code" href="test__solver_8cpp.html#a11805bf0159f4f05712c08e5b1eb580d">magic_index_value</a> = -2;</div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="test__solver_8cpp.html#a4d98aee818f565cdc2971aeeb3157178">   32</a></span>&#160;constexpr <span class="keyword">auto</span> <a class="code" href="test__solver_8cpp.html#a4d98aee818f565cdc2971aeeb3157178">magic_double_value</a> = std::numeric_limits&lt;double&gt;::lowest();</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412e">   34</a></span>&#160;<span class="keyword">enum struct</span> <a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412e">SolverImplementation</a> {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412ea8c346d0cf6d2edf77f427f5c40b97fe8">CellPermute0_CPU</a>,</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412eaaadc7fd34604d6205e36e856ae4347cf">CellPermute0_GPU</a>,</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412eae644b240b25d52b3f04785717d3e64c4">CellPermute1_CPU</a>,</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412ea970e14a39e275541316b0386b965483c">CellPermute1_GPU</a>,</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412ea7f569b7712aa3fd727cbdcf278c5643a">CellPermute2_CPU</a>,</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412eaeb69334b447ad1abc766f0f69cae3a39">CellPermute2_GPU</a>,</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412ea8ec31a529931704b9ac7ccf9e1568441">CellPermute2_CUDA</a></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;};</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="test__solver_8cpp.html#a9fc834227fc19b816fc5aead7314c7d7">   44</a></span>&#160;std::ostream&amp; <a class="code" href="namespacecoreneuron.html#af3186bb62f5703fe61cd8005741c11f9">operator&lt;&lt;</a>(std::ostream&amp; os, <a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412e">SolverImplementation</a> impl) {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">if</span> (impl == <a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412ea8c346d0cf6d2edf77f427f5c40b97fe8">SolverImplementation::CellPermute0_CPU</a>) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="keywordflow">return</span> os &lt;&lt; <span class="stringliteral">&quot;SolverImplementation::CellPermute0_CPU&quot;</span>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (impl == <a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412eaaadc7fd34604d6205e36e856ae4347cf">SolverImplementation::CellPermute0_GPU</a>) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <span class="keywordflow">return</span> os &lt;&lt; <span class="stringliteral">&quot;SolverImplementation::CellPermute0_GPU&quot;</span>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (impl == <a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412eae644b240b25d52b3f04785717d3e64c4">SolverImplementation::CellPermute1_CPU</a>) {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keywordflow">return</span> os &lt;&lt; <span class="stringliteral">&quot;SolverImplementation::CellPermute1_CPU&quot;</span>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (impl == <a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412ea970e14a39e275541316b0386b965483c">SolverImplementation::CellPermute1_GPU</a>) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keywordflow">return</span> os &lt;&lt; <span class="stringliteral">&quot;SolverImplementation::CellPermute1_GPU&quot;</span>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (impl == <a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412ea7f569b7712aa3fd727cbdcf278c5643a">SolverImplementation::CellPermute2_CPU</a>) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordflow">return</span> os &lt;&lt; <span class="stringliteral">&quot;SolverImplementation::CellPermute2_CPU&quot;</span>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (impl == <a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412eaeb69334b447ad1abc766f0f69cae3a39">SolverImplementation::CellPermute2_GPU</a>) {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keywordflow">return</span> os &lt;&lt; <span class="stringliteral">&quot;SolverImplementation::CellPermute2_GPU&quot;</span>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (impl == <a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412ea8ec31a529931704b9ac7ccf9e1568441">SolverImplementation::CellPermute2_CUDA</a>) {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keywordflow">return</span> os &lt;&lt; <span class="stringliteral">&quot;SolverImplementation::CellPermute2_CUDA&quot;</span>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Invalid SolverImplementation&quot;</span>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;}</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="struct_toy_model_config.html">   64</a></span>&#160;<span class="keyword">struct </span><a class="code" href="struct_toy_model_config.html">ToyModelConfig</a> {</div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="struct_toy_model_config.html#a4fef0c4e6ec52f271e6ea50fd357b450">   65</a></span>&#160;    <span class="keywordtype">int</span> num_threads{1};</div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="struct_toy_model_config.html#a0ac93a03771cd4bbb0168ed5ce3b4cca">   66</a></span>&#160;    <span class="keywordtype">int</span> num_cells{1};</div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="struct_toy_model_config.html#a1b8aef189e959f5fd99abb738d8ce90a">   67</a></span>&#160;    <span class="keywordtype">int</span> num_segments_per_cell{3};</div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="struct_toy_model_config.html#a54da2e492d7350a668218cd5dda38372">   68</a></span>&#160;    std::function&lt;double(<span class="keywordtype">int</span>, <span class="keywordtype">int</span>)&gt; produce_a{[](<span class="keyword">auto</span>, <span class="keyword">auto</span>) { <span class="keywordflow">return</span> 3.14159; }},</div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="struct_toy_model_config.html#a5844826eb7748e8abba977491cf3be5f">   69</a></span>&#160;        produce_b{[](<span class="keyword">auto</span>, <span class="keyword">auto</span>) { <span class="keywordflow">return</span> 42.0; }}, produce_d{[](<span class="keyword">auto</span>, <span class="keyword">auto</span>) { <span class="keywordflow">return</span> 7.0; }},</div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="struct_toy_model_config.html#a7ecd1564c1dee57d029e528128db4f3a">   70</a></span>&#160;        produce_rhs{[](<span class="keyword">auto</span>, <span class="keyword">auto</span>) { <span class="keywordflow">return</span> -16.0; }};</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;};</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">// TODO include some global lock as a sanity check (only one instance of</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">// SetupThreads should exist at any given time)</span></div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="struct_setup_threads.html">   75</a></span>&#160;<span class="keyword">struct </span><a class="code" href="struct_setup_threads.html">SetupThreads</a> {</div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="struct_setup_threads.html#a01ce4e92e6e661c38ea79383308d7107">   76</a></span>&#160;    <a class="code" href="struct_setup_threads.html#a01ce4e92e6e661c38ea79383308d7107">SetupThreads</a>(<a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412e">SolverImplementation</a> impl, <a class="code" href="struct_toy_model_config.html">ToyModelConfig</a> config = {}) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <a class="code" href="namespacecoreneuron.html#aef77588893642107a1b22047c17ea9e1">corenrn_param</a>.<a class="code" href="structcoreneuron_1_1corenrn__parameters__data.html#a84ebb3fb6afc6d1c28f8181aa4dd394d">cuda_interface</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <a class="code" href="namespacecoreneuron.html#aef77588893642107a1b22047c17ea9e1">corenrn_param</a>.<a class="code" href="structcoreneuron_1_1corenrn__parameters__data.html#abee64cfec5cc70efcbc43e0da1a94351">gpu</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordflow">switch</span> (impl) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412eaaadc7fd34604d6205e36e856ae4347cf">SolverImplementation::CellPermute0_GPU</a>:</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <a class="code" href="namespacecoreneuron.html#aef77588893642107a1b22047c17ea9e1">corenrn_param</a>.<a class="code" href="structcoreneuron_1_1corenrn__parameters__data.html#abee64cfec5cc70efcbc43e0da1a94351">gpu</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            [[fallthrough]];</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412ea8c346d0cf6d2edf77f427f5c40b97fe8">SolverImplementation::CellPermute0_CPU</a>:</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            <a class="code" href="namespacecoreneuron.html#a667da2c989834a6e63966c637899c6de">interleave_permute_type</a> = 0;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412ea970e14a39e275541316b0386b965483c">SolverImplementation::CellPermute1_GPU</a>:</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <a class="code" href="namespacecoreneuron.html#aef77588893642107a1b22047c17ea9e1">corenrn_param</a>.<a class="code" href="structcoreneuron_1_1corenrn__parameters__data.html#abee64cfec5cc70efcbc43e0da1a94351">gpu</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            [[fallthrough]];</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412eae644b240b25d52b3f04785717d3e64c4">SolverImplementation::CellPermute1_CPU</a>:</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <a class="code" href="namespacecoreneuron.html#a667da2c989834a6e63966c637899c6de">interleave_permute_type</a> = 1;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412ea8ec31a529931704b9ac7ccf9e1568441">SolverImplementation::CellPermute2_CUDA</a>:</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            <a class="code" href="namespacecoreneuron.html#aef77588893642107a1b22047c17ea9e1">corenrn_param</a>.<a class="code" href="structcoreneuron_1_1corenrn__parameters__data.html#a84ebb3fb6afc6d1c28f8181aa4dd394d">cuda_interface</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            [[fallthrough]];</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412eaeb69334b447ad1abc766f0f69cae3a39">SolverImplementation::CellPermute2_GPU</a>:</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            <a class="code" href="namespacecoreneuron.html#aef77588893642107a1b22047c17ea9e1">corenrn_param</a>.<a class="code" href="structcoreneuron_1_1corenrn__parameters__data.html#abee64cfec5cc70efcbc43e0da1a94351">gpu</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            [[fallthrough]];</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412ea7f569b7712aa3fd727cbdcf278c5643a">SolverImplementation::CellPermute2_CPU</a>:</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            <a class="code" href="namespacecoreneuron.html#a667da2c989834a6e63966c637899c6de">interleave_permute_type</a> = 2;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <a class="code" href="namespacecoreneuron.html#a6ef5948277937e3ec68daddde65f7e6f">use_solve_interleave</a> = <a class="code" href="namespacecoreneuron.html#a667da2c989834a6e63966c637899c6de">interleave_permute_type</a> &gt; 0;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <a class="code" href="namespacecoreneuron.html#a0233f6bc554fe087f0772b4fe3d544e0">nrn_threads_create</a>(config.num_threads);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <a class="code" href="namespacecoreneuron.html#a149fe28c5313b095e5907169454137fd">create_interleave_info</a>();</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordtype">int</span> num_cells_remaining{config.num_cells}, total_cells{};</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> ithread = 0; ithread &lt; <a class="code" href="namespacecoreneuron.html#a3667163cca531b5efc437cd44ecd28a8">nrn_nthread</a>; ++ithread) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="keyword">auto</span>&amp; nt = <a class="code" href="namespacecoreneuron.html#a004a963731f8a5c295fba256b92c44f1">nrn_threads</a>[ithread];</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            <span class="comment">// How many cells to distribute on this thread, trying to get the right</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            <span class="comment">// total even if num_threads does not exactly divide num_cells.</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            nt.<a class="code" href="structcoreneuron_1_1_nrn_thread.html#a6d0c441ef118780fbbe626fd027ae963">ncell</a> = num_cells_remaining / (<a class="code" href="namespacecoreneuron.html#a3667163cca531b5efc437cd44ecd28a8">nrn_nthread</a> - ithread);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            total_cells += nt.ncell;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            num_cells_remaining -= nt.ncell;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            <span class="comment">// How many segments are there in this thread?</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            nt.end = nt.ncell * config.num_segments_per_cell;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <span class="keyword">auto</span> <span class="keyword">const</span> padded_size = <a class="code" href="namespacecoreneuron.html#acc57e7378e9558c1e82f3ff872a29b79">nrn_soa_padded_size</a>(nt.end, 0);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <span class="comment">// Allocate one big block because the GPU data transfer code assumes this.</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            nt._ndata = padded_size * 4;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            nt._data = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span>*<span class="keyword">&gt;</span>(<a class="code" href="namespacecoreneuron.html#a1769af4eb2a7586cfd493c99f3d59a67">emalloc_align</a>(nt._ndata * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)));</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="keyword">auto</span>* vec_rhs = (nt._actual_rhs = nt._data + 0 * padded_size);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="keyword">auto</span>* vec_d = (nt._actual_d = nt._data + 1 * padded_size);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="keyword">auto</span>* vec_a = (nt._actual_a = nt._data + 2 * padded_size);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <span class="keyword">auto</span>* vec_b = (nt._actual_b = nt._data + 3 * padded_size);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="keyword">auto</span>* parent_indices =</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                (nt._v_parent_index = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span>*<span class="keyword">&gt;</span>(<a class="code" href="namespacecoreneuron.html#a1769af4eb2a7586cfd493c99f3d59a67">emalloc_align</a>(padded_size * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>))));</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            <span class="comment">// Magic value to check against later.</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            std::fill(parent_indices, parent_indices + nt.end, <a class="code" href="test__solver_8cpp.html#a11805bf0159f4f05712c08e5b1eb580d">magic_index_value</a>);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            <span class="comment">// Put all the root nodes first, then put the other segments</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            <span class="comment">// in blocks. i.e. ABCDAAAABBBBCCCCDDDD</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <span class="keyword">auto</span> <span class="keyword">const</span> get_index = [<a class="code" href="namespacecoreneuron.html#a20e00a6e9ccb99b25b555124b3745ef0">ncell</a> = nt.ncell,</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                                    nseg = config.num_segments_per_cell](<span class="keyword">auto</span> icell, <span class="keyword">auto</span> iseg) {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                <span class="keywordflow">if</span> (iseg == 0) {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                    <span class="keywordflow">return</span> icell;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="namespacecoreneuron.html#a20e00a6e9ccb99b25b555124b3745ef0">ncell</a> + icell * (nseg - 1) + iseg - 1;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            };</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> icell = 0; icell &lt; nt.ncell; ++icell) {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span> iseg = 0; iseg &lt; config.num_segments_per_cell; ++iseg) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                    <span class="keyword">auto</span> <span class="keyword">const</span> global_index = get_index(icell, iseg);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                    vec_a[global_index] = config.produce_a(icell, iseg);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                    vec_b[global_index] = config.produce_b(icell, iseg);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                    vec_d[global_index] = config.produce_d(icell, iseg);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                    vec_rhs[global_index] = config.produce_rhs(icell, iseg);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                    <span class="comment">// 0th element is the root node, which has no parent</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                    <span class="comment">// other elements are attached in a binary tree configuration</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                    <span class="comment">// |      0      |</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                    <span class="comment">// |    /   \    |</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                    <span class="comment">// |   1     2   |</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                    <span class="comment">// |  / \   / \  |</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                    <span class="comment">// | 3   4 5   6 |</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                    <span class="comment">// TODO: include some other topologies, e.g. a long straight line, or</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                    <span class="comment">// an unbalanced tree.</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                    <span class="keyword">auto</span> <span class="keyword">const</span> parent_id = iseg ? get_index(icell, (iseg - 1) / 2) : -1;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                    parent_indices[global_index] = parent_id;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <span class="comment">// Check we didn&#39;t mess up populating any parent indices</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> = 0; <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> &lt; nt.end; ++<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>) {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                REQUIRE(parent_indices[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>] != <a class="code" href="test__solver_8cpp.html#a11805bf0159f4f05712c08e5b1eb580d">magic_index_value</a>);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                <span class="comment">// Root nodes should come first for --cell-permute=0</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> &lt; nt.ncell) {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                    REQUIRE(parent_indices[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>] == -1);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespacecoreneuron.html#a667da2c989834a6e63966c637899c6de">interleave_permute_type</a>) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                nt._permute = <a class="code" href="namespacecoreneuron.html#aedde05210cb083e16e796c5ba73b4fa3">interleave_order</a>(nt.id, nt.ncell, nt.end, parent_indices);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                REQUIRE(nt._permute);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                <a class="code" href="namespacecoreneuron.html#ae74051448767fb356499afd960bb6040">permute_data</a>(vec_a, nt.end, nt._permute);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                <a class="code" href="namespacecoreneuron.html#ae74051448767fb356499afd960bb6040">permute_data</a>(vec_b, nt.end, nt._permute);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                <span class="comment">// This isn&#39;t done in CoreNEURON because these are reset every</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                <span class="comment">// time step, but permute d/rhs here so that the initial values</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                <span class="comment">// set by produce_d and produce_rhs are propagated consistently</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                <span class="comment">// to all of the solver implementations.</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                <a class="code" href="namespacecoreneuron.html#ae74051448767fb356499afd960bb6040">permute_data</a>(vec_d, nt.end, nt._permute);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                <a class="code" href="namespacecoreneuron.html#ae74051448767fb356499afd960bb6040">permute_data</a>(vec_rhs, nt.end, nt._permute);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                <span class="comment">// index values change as well as ordering</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                <a class="code" href="namespacecoreneuron.html#a46e81f32cfe741466495564aa42ece20">permute_ptr</a>(parent_indices, nt.end, nt._permute);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                <a class="code" href="namespacecoreneuron.html#ab5791af02b3ac68e31ac6640fac4b11d">node_permute</a>(parent_indices, nt.end, nt._permute);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordflow">if</span> (impl == <a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412eaaadc7fd34604d6205e36e856ae4347cf">SolverImplementation::CellPermute0_GPU</a>) {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;CellPermute0_GPU is a nonstandard configuration, copying data to the &quot;</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                         <span class="stringliteral">&quot;device may produce warnings:&quot;</span>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacecoreneuron.html#aef77588893642107a1b22047c17ea9e1">corenrn_param</a>.<a class="code" href="structcoreneuron_1_1corenrn__parameters__data.html#abee64cfec5cc70efcbc43e0da1a94351">gpu</a>) {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <a class="code" href="namespacecoreneuron.html#ac5fe218ef440ab371415488310ec76c2">setup_nrnthreads_on_device</a>(<a class="code" href="namespacecoreneuron.html#a004a963731f8a5c295fba256b92c44f1">nrn_threads</a>, <a class="code" href="namespacecoreneuron.html#a3667163cca531b5efc437cd44ecd28a8">nrn_nthread</a>);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordflow">if</span> (impl == <a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412eaaadc7fd34604d6205e36e856ae4347cf">SolverImplementation::CellPermute0_GPU</a>) {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;\n...no more warnings expected&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="comment">// Make sure we produced the number of cells we were aiming for</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        REQUIRE(total_cells == config.num_cells);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        REQUIRE(num_cells_remaining == 0);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="struct_setup_threads.html#a6dc8592dcca5239513a96a9155ca53d9">  196</a></span>&#160;    <a class="code" href="struct_setup_threads.html#a6dc8592dcca5239513a96a9155ca53d9">~SetupThreads</a>() {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacecoreneuron.html#aef77588893642107a1b22047c17ea9e1">corenrn_param</a>.<a class="code" href="structcoreneuron_1_1corenrn__parameters__data.html#abee64cfec5cc70efcbc43e0da1a94351">gpu</a>) {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <a class="code" href="namespacecoreneuron.html#aaf6455e4a476692eb81f8c8fd195f01c">delete_nrnthreads_on_device</a>(<a class="code" href="namespacecoreneuron.html#a004a963731f8a5c295fba256b92c44f1">nrn_threads</a>, <a class="code" href="namespacecoreneuron.html#a3667163cca531b5efc437cd44ecd28a8">nrn_nthread</a>);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; nt: *<span class="keyword">this</span>) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            <a class="code" href="memory_8h.html#a65e85cd69dc6beb7fc5ea07ce3c911d8">free_memory</a>(std::exchange(nt._data, <span class="keyword">nullptr</span>));</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="keyword">delete</span>[] std::exchange(nt._permute, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <a class="code" href="memory_8h.html#a65e85cd69dc6beb7fc5ea07ce3c911d8">free_memory</a>(std::exchange(nt._v_parent_index, <span class="keyword">nullptr</span>));</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <a class="code" href="namespacecoreneuron.html#a0d622e7fc447409d8d9e9e9c0cc887bc">destroy_interleave_info</a>();</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <a class="code" href="namespacecoreneuron.html#aa80ee7c294b231b9e2c5d67a83c5b4bd">nrn_threads_free</a>();</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno"><a class="line" href="struct_setup_threads.html#aef1ce15f5e675e79acac564c0c5a8aa0">  209</a></span>&#160;    <span class="keyword">auto</span> <a class="code" href="struct_setup_threads.html#aef1ce15f5e675e79acac564c0c5a8aa0">dump_solver_data</a>() {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        std::vector&lt;SolverData&gt; <a class="code" href="redef_8h.html#ae7b1d18a435dcca5e1837205e5fc909d">ret</a>{<span class="keyword">static_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(<a class="code" href="namespacecoreneuron.html#a3667163cca531b5efc437cd44ecd28a8">nrn_nthread</a>)};</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="comment">// Sync the solver data from GPU to host</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <a class="code" href="namespacecoreneuron.html#a464e68031caebeafea98c00441dadc77">update_nrnthreads_on_host</a>(<a class="code" href="namespacecoreneuron.html#a004a963731f8a5c295fba256b92c44f1">nrn_threads</a>, <a class="code" href="namespacecoreneuron.html#a3667163cca531b5efc437cd44ecd28a8">nrn_nthread</a>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="comment">// Un-permute the data in and store it in ret.{d,parent_index,rhs}</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> = 0; <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> &lt; <a class="code" href="namespacecoreneuron.html#a3667163cca531b5efc437cd44ecd28a8">nrn_nthread</a>; ++<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>) {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            <span class="keyword">auto</span>&amp; nt = <a class="code" href="namespacecoreneuron.html#a004a963731f8a5c295fba256b92c44f1">nrn_threads</a>[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>];</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <span class="keyword">auto</span>&amp; sd = <a class="code" href="redef_8h.html#ae7b1d18a435dcca5e1837205e5fc909d">ret</a>[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>];</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            sd.d.resize(nt.end, <a class="code" href="test__solver_8cpp.html#a4d98aee818f565cdc2971aeeb3157178">magic_double_value</a>);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            sd.parent_index.resize(nt.end, <a class="code" href="test__solver_8cpp.html#a11805bf0159f4f05712c08e5b1eb580d">magic_index_value</a>);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            sd.rhs.resize(nt.end, <a class="code" href="test__solver_8cpp.html#a4d98aee818f565cdc2971aeeb3157178">magic_double_value</a>);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            <span class="keyword">auto</span>* <a class="code" href="namespacecoreneuron.html#a3b69d9036b0f12c7710e95153186e5d0">inv_permute</a> = nt._permute ? <a class="code" href="namespacecoreneuron.html#aa128e53f31aa5d4fda7a72f7d375df6c">inverse_permute</a>(nt._permute, nt.end) : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> = 0; <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> &lt; nt.end; ++<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                <span class="comment">// index in permuted vectors</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                <span class="keyword">auto</span> <span class="keyword">const</span> p_i = nt._permute ? nt._permute[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>] : <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                <span class="comment">// parent index in permuted vectors</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                <span class="keyword">auto</span> <span class="keyword">const</span> p_parent = nt._v_parent_index[p_i];</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                <span class="comment">// parent index in unpermuted vectors (i.e. on the same scale as `i`)</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                <span class="keyword">auto</span> <span class="keyword">const</span> parent = p_parent == -1</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                                        ? -1</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                                        : (<a class="code" href="namespacecoreneuron.html#a3b69d9036b0f12c7710e95153186e5d0">inv_permute</a> ? <a class="code" href="namespacecoreneuron.html#a3b69d9036b0f12c7710e95153186e5d0">inv_permute</a>[p_parent] : p_parent);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                <span class="comment">// Save the values to the de-permuted return structure</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                sd.d[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>] = nt._actual_d[p_i];</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                sd.parent_index[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>] = parent;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                sd.rhs[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>] = nt._actual_rhs[p_i];</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="keyword">delete</span>[] <a class="code" href="namespacecoreneuron.html#a3b69d9036b0f12c7710e95153186e5d0">inv_permute</a>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> = 0; <a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> &lt; nt.end; ++<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                REQUIRE(sd.d[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>] != <a class="code" href="test__solver_8cpp.html#a4d98aee818f565cdc2971aeeb3157178">magic_double_value</a>);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                REQUIRE(sd.parent_index[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>] != <a class="code" href="test__solver_8cpp.html#a11805bf0159f4f05712c08e5b1eb580d">magic_index_value</a>);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                REQUIRE(sd.rhs[<a class="code" href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>] != <a class="code" href="test__solver_8cpp.html#a4d98aee818f565cdc2971aeeb3157178">magic_double_value</a>);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="redef_8h.html#ae7b1d18a435dcca5e1837205e5fc909d">ret</a>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="struct_setup_threads.html#a0832d645de6d50f363d193e6c03ef016">  245</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="struct_setup_threads.html#a0832d645de6d50f363d193e6c03ef016">solve</a>() {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; thread: *<span class="keyword">this</span>) {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <a class="code" href="namespacecoreneuron.html#a9ae62756eb6d6e2ec22a34e48d252506">nrn_solve_minimal</a>(&amp;thread);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="struct_setup_threads.html#a0b6d00fc61f0bd86bbbedc57309314f9">  251</a></span>&#160;    <a class="code" href="structcoreneuron_1_1_nrn_thread.html">NrnThread</a>* <a class="code" href="struct_setup_threads.html#a0b6d00fc61f0bd86bbbedc57309314f9">begin</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacecoreneuron.html#a004a963731f8a5c295fba256b92c44f1">nrn_threads</a>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    }</div>
<div class="line"><a name="l00254"></a><span class="lineno"><a class="line" href="struct_setup_threads.html#a967f8ae06e82c594ece92fbd77daf749">  254</a></span>&#160;    <a class="code" href="structcoreneuron_1_1_nrn_thread.html">NrnThread</a>* <a class="code" href="struct_setup_threads.html#a967f8ae06e82c594ece92fbd77daf749">end</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacecoreneuron.html#a004a963731f8a5c295fba256b92c44f1">nrn_threads</a> + <a class="code" href="namespacecoreneuron.html#a3667163cca531b5efc437cd44ecd28a8">nrn_nthread</a>;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    }</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;};</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span>... Args&gt;</div>
<div class="line"><a name="l00260"></a><span class="lineno"><a class="line" href="test__solver_8cpp.html#a68618291a00bbc8ec9a8c824e5a70727">  260</a></span>&#160;<span class="keyword">auto</span> <a class="code" href="test__solver_8cpp.html#a68618291a00bbc8ec9a8c824e5a70727">solve_and_dump</a>(Args&amp;&amp;... args) {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <a class="code" href="struct_setup_threads.html">SetupThreads</a> threads{std::forward&lt;Args&gt;(args)...};</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    threads.<a class="code" href="struct_setup_threads.html#a0832d645de6d50f363d193e6c03ef016">solve</a>();</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">return</span> threads.dump_solver_data();</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;}</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="test__solver_8cpp.html#a387c28f132c929b444a3008052c15606">  266</a></span>&#160;<span class="keyword">auto</span> <a class="code" href="test__solver_8cpp.html#a387c28f132c929b444a3008052c15606">active_implementations</a>() {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">// These are always available</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    std::vector&lt;SolverImplementation&gt; <a class="code" href="redef_8h.html#ae7b1d18a435dcca5e1837205e5fc909d">ret</a>{<a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412ea8c346d0cf6d2edf77f427f5c40b97fe8">SolverImplementation::CellPermute0_CPU</a>,</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                                          <a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412eae644b240b25d52b3f04785717d3e64c4">SolverImplementation::CellPermute1_CPU</a>,</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                                          <a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412ea7f569b7712aa3fd727cbdcf278c5643a">SolverImplementation::CellPermute2_CPU</a>};</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="preprocessor">#ifdef CORENEURON_ENABLE_GPU</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">// Consider making these steerable via a runtime switch in GPU builds</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <a class="code" href="redef_8h.html#ae7b1d18a435dcca5e1837205e5fc909d">ret</a>.push_back(<a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412eaaadc7fd34604d6205e36e856ae4347cf">SolverImplementation::CellPermute0_GPU</a>);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="redef_8h.html#ae7b1d18a435dcca5e1837205e5fc909d">ret</a>.push_back(<a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412ea970e14a39e275541316b0386b965483c">SolverImplementation::CellPermute1_GPU</a>);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="redef_8h.html#ae7b1d18a435dcca5e1837205e5fc909d">ret</a>.push_back(<a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412eaeb69334b447ad1abc766f0f69cae3a39">SolverImplementation::CellPermute2_GPU</a>);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="redef_8h.html#ae7b1d18a435dcca5e1837205e5fc909d">ret</a>.push_back(<a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412ea8ec31a529931704b9ac7ccf9e1568441">SolverImplementation::CellPermute2_CUDA</a>);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="redef_8h.html#ae7b1d18a435dcca5e1837205e5fc909d">ret</a>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;}</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno"><a class="line" href="test__solver_8cpp.html#a3cd33a50af827d1a2ee8ca04bd897b35">  281</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="test__solver_8cpp.html#a3cd33a50af827d1a2ee8ca04bd897b35">compare_solver_data</a>(</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <a class="code" href="mlinedit_8cpp.html#a7b109ded19176468549dea01f3fca60c">std::map</a>&lt;<a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412e">SolverImplementation</a>, std::vector&lt;SolverData&gt;&gt; <span class="keyword">const</span>&amp; solver_data) {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">// CellPermute0_CPU is the simplest version of the solver, it should always</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="comment">// be present and it&#39;s a good reference to use</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    constexpr <span class="keyword">auto</span> ref_impl = <a class="code" href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412ea8c346d0cf6d2edf77f427f5c40b97fe8">SolverImplementation::CellPermute0_CPU</a>;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    REQUIRE(solver_data.find(ref_impl) != solver_data.end());</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span>&amp; ref_data = solver_data.at(ref_impl);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; [impl, impl_data]: solver_data) {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="comment">// Must have compatible numbers of threads.</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        REQUIRE(impl_data.size() == ref_data.size());</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Comparing &quot;</span> &lt;&lt; impl &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; ref_impl &lt;&lt; std::endl;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> n_thread = 0ul; n_thread &lt; impl_data.size(); ++n_thread) {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <span class="comment">// Must have compatible numbers of segments/data entries</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            REQUIRE(impl_data[n_thread].d.size() == ref_data[n_thread].d.size());</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            REQUIRE(impl_data[n_thread].parent_index.size() ==</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                    ref_data[n_thread].parent_index.size());</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            REQUIRE(impl_data[n_thread].<a class="code" href="lineq_8h.html#a1939c197093fe6b7fa35494fd046328d">rhs</a>.size() == ref_data[n_thread].rhs.size());</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            CHECK_THAT(impl_data[n_thread].d, Catch::Approx(ref_data[n_thread].d));</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            REQUIRE(impl_data[n_thread].parent_index == ref_data[n_thread].parent_index);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            CHECK_THAT(impl_data[n_thread].<a class="code" href="lineq_8h.html#a1939c197093fe6b7fa35494fd046328d">rhs</a>, Catch::Approx(ref_data[n_thread].<a class="code" href="lineq_8h.html#a1939c197093fe6b7fa35494fd046328d">rhs</a>));</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;}</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span>... Args&gt;</div>
<div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="test__solver_8cpp.html#a70b83806565dfb8c29aeb03236ef459b">  306</a></span>&#160;<span class="keyword">auto</span> <a class="code" href="test__solver_8cpp.html#a70b83806565dfb8c29aeb03236ef459b">compare_all_active_implementations</a>(Args&amp;&amp;... args) {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    std::map&lt;SolverImplementation, std::vector&lt;SolverData&gt;&gt; solver_data;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> impl: <a class="code" href="test__solver_8cpp.html#a387c28f132c929b444a3008052c15606">active_implementations</a>()) {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        solver_data[impl] = <a class="code" href="test__solver_8cpp.html#a68618291a00bbc8ec9a8c824e5a70727">solve_and_dump</a>(impl, std::forward&lt;Args&gt;(args)...);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="test__solver_8cpp.html#a3cd33a50af827d1a2ee8ca04bd897b35">compare_solver_data</a>(solver_data);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">return</span> solver_data;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;}</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">// *Roughly* tuned to accomodate NVHPC 22.3 at -O0; the largest differences come</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">// from the pseudorandom seeded tests.</span></div>
<div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="test__solver_8cpp.html#afa624dd14df4686b7bbd81d28ff731fb">  317</a></span>&#160;constexpr <span class="keywordtype">double</span> <a class="code" href="test__solver_8cpp.html#afa624dd14df4686b7bbd81d28ff731fb">default_tolerance</a> = 2e-11;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno"><a class="line" href="test__solver_8cpp.html#a706e782afe803bc26f5e19d7f158e575">  319</a></span>&#160;<a class="code" href="test__solver_8cpp.html#a706e782afe803bc26f5e19d7f158e575">TEST_CASE</a>(<span class="stringliteral">&quot;SingleCellAndThread&quot;</span>, <span class="stringliteral">&quot;[solver][single-thread]&quot;</span>) {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    constexpr std::size_t segments = 32;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <a class="code" href="struct_toy_model_config.html">ToyModelConfig</a> config{};</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    config.<a class="code" href="struct_toy_model_config.html#a1b8aef189e959f5fd99abb738d8ce90a">num_segments_per_cell</a> = segments;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> solver_data = <a class="code" href="test__solver_8cpp.html#a70b83806565dfb8c29aeb03236ef459b">compare_all_active_implementations</a>(config);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; [impl, <a class="code" href="structdata.html">data</a>]: solver_data) {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        REQUIRE(<a class="code" href="structdata.html">data</a>.size() == 1);  <span class="comment">// nthreads</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        REQUIRE(<a class="code" href="structdata.html">data</a>[0].d.size() == segments);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        REQUIRE(<a class="code" href="structdata.html">data</a>[0].parent_index.size() == segments);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        REQUIRE(<a class="code" href="structdata.html">data</a>[0].<a class="code" href="lineq_8h.html#a1939c197093fe6b7fa35494fd046328d">rhs</a>.size() == segments);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;}</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno"><a class="line" href="test__solver_8cpp.html#a711fa9a6f63550f7df8b608229f52dc9">  332</a></span>&#160;<a class="code" href="test__solver_8cpp.html#a706e782afe803bc26f5e19d7f158e575">TEST_CASE</a>(<span class="stringliteral">&quot;UnbalancedCellSingleThread&quot;</span>, <span class="stringliteral">&quot;[solver][single-thread]&quot;</span>) {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <a class="code" href="struct_toy_model_config.html">ToyModelConfig</a> config{};</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    config.<a class="code" href="struct_toy_model_config.html#a1b8aef189e959f5fd99abb738d8ce90a">num_segments_per_cell</a> = 19;  <span class="comment">// not a nice round number</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <a class="code" href="test__solver_8cpp.html#a70b83806565dfb8c29aeb03236ef459b">compare_all_active_implementations</a>(config);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;}</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno"><a class="line" href="test__solver_8cpp.html#a3dddb36b86da6fbb9988e128e173f0e0">  338</a></span>&#160;<a class="code" href="test__solver_8cpp.html#a706e782afe803bc26f5e19d7f158e575">TEST_CASE</a>(<span class="stringliteral">&quot;LargeCellSingleThread&quot;</span>, <span class="stringliteral">&quot;[solver][single-thread]&quot;</span>) {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <a class="code" href="struct_toy_model_config.html">ToyModelConfig</a> config{};</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    config.<a class="code" href="struct_toy_model_config.html#a1b8aef189e959f5fd99abb738d8ce90a">num_segments_per_cell</a> = 4096;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <a class="code" href="test__solver_8cpp.html#a70b83806565dfb8c29aeb03236ef459b">compare_all_active_implementations</a>(config);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;}</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno"><a class="line" href="test__solver_8cpp.html#ab928eada3a88f2523c172fd6e2cbaa00">  344</a></span>&#160;<a class="code" href="test__solver_8cpp.html#a706e782afe803bc26f5e19d7f158e575">TEST_CASE</a>(<span class="stringliteral">&quot;ManySmallCellsSingleThread&quot;</span>, <span class="stringliteral">&quot;[solver][single-thread]&quot;</span>) {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <a class="code" href="struct_toy_model_config.html">ToyModelConfig</a> config{};</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    config.<a class="code" href="struct_toy_model_config.html#a0ac93a03771cd4bbb0168ed5ce3b4cca">num_cells</a> = 1024;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <a class="code" href="test__solver_8cpp.html#a70b83806565dfb8c29aeb03236ef459b">compare_all_active_implementations</a>(config);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;}</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno"><a class="line" href="test__solver_8cpp.html#a7f2970ffe7b902fad78af9eb6d2800d4">  350</a></span>&#160;<a class="code" href="test__solver_8cpp.html#a706e782afe803bc26f5e19d7f158e575">TEST_CASE</a>(<span class="stringliteral">&quot;ManySmallCellsMultiThread&quot;</span>, <span class="stringliteral">&quot;[solver][multi-thread]&quot;</span>) {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <a class="code" href="struct_toy_model_config.html">ToyModelConfig</a> config{};</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    config.<a class="code" href="struct_toy_model_config.html#a0ac93a03771cd4bbb0168ed5ce3b4cca">num_cells</a> = 1024;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    config.num_threads = 2;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <a class="code" href="test__solver_8cpp.html#a70b83806565dfb8c29aeb03236ef459b">compare_all_active_implementations</a>(config);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;}</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno"><a class="line" href="test__solver_8cpp.html#a332943ed8722a743e7470d684f424ccd">  357</a></span>&#160;<span class="keyword">auto</span> <a class="code" href="test__solver_8cpp.html#a332943ed8722a743e7470d684f424ccd">random_config</a>() {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    std::mt19937_64 gen{42};</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <a class="code" href="struct_toy_model_config.html">ToyModelConfig</a> config{};</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    config.<a class="code" href="struct_toy_model_config.html#a54da2e492d7350a668218cd5dda38372">produce_a</a> = [g = gen, d = std::normal_distribution{1.0, 0.1}](<span class="keywordtype">int</span> icell,</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                                                                         <span class="keywordtype">int</span> iseg) <span class="keyword">mutable</span> {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordflow">return</span> d(g);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    };</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    config.produce_b = [g = gen, d = std::normal_distribution{7.0, 0.2}](int, int) <span class="keyword">mutable</span> {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="keywordflow">return</span> d(g);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    };</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    config.produce_d = [g = gen, d = std::normal_distribution{-0.1, 0.01}](int, int) <span class="keyword">mutable</span> {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="keywordflow">return</span> d(g);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    };</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    config.produce_rhs = [g = gen, d = std::normal_distribution{-15.0, 2.0}](int, int) <span class="keyword">mutable</span> {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="keywordflow">return</span> d(g);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    };</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordflow">return</span> config;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;}</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno"><a class="line" href="test__solver_8cpp.html#ae939dc46158d2603b763c96a05e9f0fd">  376</a></span>&#160;<a class="code" href="test__solver_8cpp.html#a706e782afe803bc26f5e19d7f158e575">TEST_CASE</a>(<span class="stringliteral">&quot;LargeCellSingleThreadRandom&quot;</span>, <span class="stringliteral">&quot;[solver][single-thread][random]&quot;</span>) {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keyword">auto</span> config = <a class="code" href="test__solver_8cpp.html#a332943ed8722a743e7470d684f424ccd">random_config</a>();</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    config.num_segments_per_cell = 4096;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <a class="code" href="test__solver_8cpp.html#a70b83806565dfb8c29aeb03236ef459b">compare_all_active_implementations</a>(config);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;}</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno"><a class="line" href="test__solver_8cpp.html#ae3d9dd78284593d5ce7f60f92389f3bb">  382</a></span>&#160;<a class="code" href="test__solver_8cpp.html#a706e782afe803bc26f5e19d7f158e575">TEST_CASE</a>(<span class="stringliteral">&quot;ManySmallCellsSingleThreadRandom&quot;</span>, <span class="stringliteral">&quot;[solver][single-thread][random]&quot;</span>) {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keyword">auto</span> config = <a class="code" href="test__solver_8cpp.html#a332943ed8722a743e7470d684f424ccd">random_config</a>();</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    config.num_cells = 1024;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <a class="code" href="test__solver_8cpp.html#a70b83806565dfb8c29aeb03236ef459b">compare_all_active_implementations</a>(config);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="acoreneuron_2nrnoc_2md1redef_8h_html_ae46bd26d7133dfe98f8cec7c5ac5c7a1"><div class="ttname"><a href="coreneuron_2nrnoc_2md1redef_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="coreneuron_2nrnoc_2md1redef_8h_source.html#l00019">md1redef.h:19</a></div></div>
<div class="ttc" id="amlinedit_8cpp_html_a7b109ded19176468549dea01f3fca60c"><div class="ttname"><a href="mlinedit_8cpp.html#a7b109ded19176468549dea01f3fca60c">map</a></div><div class="ttdeci">static double map(void *v)</div><div class="ttdef"><b>Definition:</b> <a href="mlinedit_8cpp_source.html#l00043">mlinedit.cpp:43</a></div></div>
<div class="ttc" id="anamespacecoreneuron_html_ac5fe218ef440ab371415488310ec76c2"><div class="ttname"><a href="namespacecoreneuron.html#ac5fe218ef440ab371415488310ec76c2">coreneuron::setup_nrnthreads_on_device</a></div><div class="ttdeci">void setup_nrnthreads_on_device(NrnThread *threads, int nthreads)</div><div class="ttdef"><b>Definition:</b> <a href="nrn__acc__manager_8cpp_source.html#l00466">nrn_acc_manager.cpp:466</a></div></div>
<div class="ttc" id="anamespacecoreneuron_html_aedde05210cb083e16e796c5ba73b4fa3"><div class="ttname"><a href="namespacecoreneuron.html#aedde05210cb083e16e796c5ba73b4fa3">coreneuron::interleave_order</a></div><div class="ttdeci">int * interleave_order(int ith, int ncell, int nnode, int *parent)</div><div class="ttdoc">Function that performs the permutation of the cells such that the execution threads access coalesced ...</div><div class="ttdef"><b>Definition:</b> <a href="cellorder_8cpp_source.html#l00288">cellorder.cpp:288</a></div></div>
<div class="ttc" id="amemory_8h_html_a65e85cd69dc6beb7fc5ea07ce3c911d8"><div class="ttname"><a href="memory_8h.html#a65e85cd69dc6beb7fc5ea07ce3c911d8">free_memory</a></div><div class="ttdeci">void free_memory(void *pointer)</div><div class="ttdef"><b>Definition:</b> <a href="memory_8h_source.html#l00197">memory.h:197</a></div></div>
<div class="ttc" id="atest__solver_8cpp_html_a68618291a00bbc8ec9a8c824e5a70727"><div class="ttname"><a href="test__solver_8cpp.html#a68618291a00bbc8ec9a8c824e5a70727">solve_and_dump</a></div><div class="ttdeci">auto solve_and_dump(Args &amp;&amp;... args)</div><div class="ttdef"><b>Definition:</b> <a href="test__solver_8cpp_source.html#l00260">test_solver.cpp:260</a></div></div>
<div class="ttc" id="atest__solver_8cpp_html_a8397aa081f2b0eebb70b227d2e46412ea7f569b7712aa3fd727cbdcf278c5643a"><div class="ttname"><a href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412ea7f569b7712aa3fd727cbdcf278c5643a">SolverImplementation::CellPermute2_CPU</a></div><div class="ttdeci">@ CellPermute2_CPU</div></div>
<div class="ttc" id="anamespacecoreneuron_html_a3667163cca531b5efc437cd44ecd28a8"><div class="ttname"><a href="namespacecoreneuron.html#a3667163cca531b5efc437cd44ecd28a8">coreneuron::nrn_nthread</a></div><div class="ttdeci">int nrn_nthread</div><div class="ttdef"><b>Definition:</b> <a href="coreneuron_2sim_2multicore_8cpp_source.html#l00055">multicore.cpp:55</a></div></div>
<div class="ttc" id="astruct_toy_model_config_html_a54da2e492d7350a668218cd5dda38372"><div class="ttname"><a href="struct_toy_model_config.html#a54da2e492d7350a668218cd5dda38372">ToyModelConfig::produce_a</a></div><div class="ttdeci">std::function&lt; double(int, int)&gt; produce_a</div><div class="ttdef"><b>Definition:</b> <a href="test__solver_8cpp_source.html#l00068">test_solver.cpp:68</a></div></div>
<div class="ttc" id="anamespacecoreneuron_html_aaf6455e4a476692eb81f8c8fd195f01c"><div class="ttname"><a href="namespacecoreneuron.html#aaf6455e4a476692eb81f8c8fd195f01c">coreneuron::delete_nrnthreads_on_device</a></div><div class="ttdeci">void delete_nrnthreads_on_device(NrnThread *threads, int nthreads)</div><div class="ttdoc">Cleanup device memory that is being tracked by the OpenACC runtime.</div><div class="ttdef"><b>Definition:</b> <a href="nrn__acc__manager_8cpp_source.html#l01151">nrn_acc_manager.cpp:1151</a></div></div>
<div class="ttc" id="astruct_toy_model_config_html_a0ac93a03771cd4bbb0168ed5ce3b4cca"><div class="ttname"><a href="struct_toy_model_config.html#a0ac93a03771cd4bbb0168ed5ce3b4cca">ToyModelConfig::num_cells</a></div><div class="ttdeci">int num_cells</div><div class="ttdef"><b>Definition:</b> <a href="test__solver_8cpp_source.html#l00066">test_solver.cpp:66</a></div></div>
<div class="ttc" id="anamespacecoreneuron_html_a3b69d9036b0f12c7710e95153186e5d0"><div class="ttname"><a href="namespacecoreneuron.html#a3b69d9036b0f12c7710e95153186e5d0">coreneuron::inv_permute</a></div><div class="ttdeci">static int inv_permute(int i, NrnThread &amp;nt)</div><div class="ttdef"><b>Definition:</b> <a href="coreneuron_2io_2prcellstate_8cpp_source.html#l00032">prcellstate.cpp:32</a></div></div>
<div class="ttc" id="anamespacecoreneuron_html_a464e68031caebeafea98c00441dadc77"><div class="ttname"><a href="namespacecoreneuron.html#a464e68031caebeafea98c00441dadc77">coreneuron::update_nrnthreads_on_host</a></div><div class="ttdeci">void update_nrnthreads_on_host(NrnThread *threads, int nthreads)</div><div class="ttdef"><b>Definition:</b> <a href="nrn__acc__manager_8cpp_source.html#l01012">nrn_acc_manager.cpp:1012</a></div></div>
<div class="ttc" id="astructdata_html"><div class="ttname"><a href="structdata.html">data</a></div><div class="ttdef"><b>Definition:</b> <a href="alignment_8cpp_source.html#l00018">alignment.cpp:18</a></div></div>
<div class="ttc" id="astruct_setup_threads_html_a967f8ae06e82c594ece92fbd77daf749"><div class="ttname"><a href="struct_setup_threads.html#a967f8ae06e82c594ece92fbd77daf749">SetupThreads::end</a></div><div class="ttdeci">NrnThread * end() const</div><div class="ttdef"><b>Definition:</b> <a href="test__solver_8cpp_source.html#l00254">test_solver.cpp:254</a></div></div>
<div class="ttc" id="astruct_solver_data_html_ab78f9ca29611b33465bbbb1fe682dd64"><div class="ttname"><a href="struct_solver_data.html#ab78f9ca29611b33465bbbb1fe682dd64">SolverData::parent_index</a></div><div class="ttdeci">std::vector&lt; int &gt; parent_index</div><div class="ttdef"><b>Definition:</b> <a href="test__solver_8cpp_source.html#l00028">test_solver.cpp:28</a></div></div>
<div class="ttc" id="atest__solver_8cpp_html_a8397aa081f2b0eebb70b227d2e46412ea8ec31a529931704b9ac7ccf9e1568441"><div class="ttname"><a href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412ea8ec31a529931704b9ac7ccf9e1568441">SolverImplementation::CellPermute2_CUDA</a></div><div class="ttdeci">@ CellPermute2_CUDA</div></div>
<div class="ttc" id="atest__solver_8cpp_html_a8397aa081f2b0eebb70b227d2e46412eaeb69334b447ad1abc766f0f69cae3a39"><div class="ttname"><a href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412eaeb69334b447ad1abc766f0f69cae3a39">SolverImplementation::CellPermute2_GPU</a></div><div class="ttdeci">@ CellPermute2_GPU</div></div>
<div class="ttc" id="anamespacecoreneuron_html_aa80ee7c294b231b9e2c5d67a83c5b4bd"><div class="ttname"><a href="namespacecoreneuron.html#aa80ee7c294b231b9e2c5d67a83c5b4bd">coreneuron::nrn_threads_free</a></div><div class="ttdeci">void nrn_threads_free()</div><div class="ttdef"><b>Definition:</b> <a href="coreneuron_2sim_2multicore_8cpp_source.html#l00125">multicore.cpp:125</a></div></div>
<div class="ttc" id="anrn__acc__manager_8hpp_html"><div class="ttname"><a href="nrn__acc__manager_8hpp.html">nrn_acc_manager.hpp</a></div></div>
<div class="ttc" id="atest__solver_8cpp_html_a11805bf0159f4f05712c08e5b1eb580d"><div class="ttname"><a href="test__solver_8cpp.html#a11805bf0159f4f05712c08e5b1eb580d">magic_index_value</a></div><div class="ttdeci">constexpr auto magic_index_value</div><div class="ttdef"><b>Definition:</b> <a href="test__solver_8cpp_source.html#l00031">test_solver.cpp:31</a></div></div>
<div class="ttc" id="anamespacecoreneuron_html_a9ae62756eb6d6e2ec22a34e48d252506"><div class="ttname"><a href="namespacecoreneuron.html#a9ae62756eb6d6e2ec22a34e48d252506">coreneuron::nrn_solve_minimal</a></div><div class="ttdeci">void nrn_solve_minimal(NrnThread *)</div><div class="ttdef"><b>Definition:</b> <a href="solve__core_8cpp_source.html#l00018">solve_core.cpp:18</a></div></div>
<div class="ttc" id="anamespacecoreneuron_html_ae74051448767fb356499afd960bb6040"><div class="ttname"><a href="namespacecoreneuron.html#ae74051448767fb356499afd960bb6040">coreneuron::permute_data</a></div><div class="ttdeci">void permute_data(double *vec, int n, int *p)</div><div class="ttdef"><b>Definition:</b> <a href="node__permute_8cpp_source.html#l00349">node_permute.cpp:349</a></div></div>
<div class="ttc" id="anamespacecoreneuron_html_a0233f6bc554fe087f0772b4fe3d544e0"><div class="ttname"><a href="namespacecoreneuron.html#a0233f6bc554fe087f0772b4fe3d544e0">coreneuron::nrn_threads_create</a></div><div class="ttdeci">void nrn_threads_create(int n)</div><div class="ttdef"><b>Definition:</b> <a href="coreneuron_2sim_2multicore_8cpp_source.html#l00102">multicore.cpp:102</a></div></div>
<div class="ttc" id="astructcoreneuron_1_1corenrn__parameters__data_html_abee64cfec5cc70efcbc43e0da1a94351"><div class="ttname"><a href="structcoreneuron_1_1corenrn__parameters__data.html#abee64cfec5cc70efcbc43e0da1a94351">coreneuron::corenrn_parameters_data::gpu</a></div><div class="ttdeci">bool gpu</div><div class="ttdoc">Enable pthread/openmp.</div><div class="ttdef"><b>Definition:</b> <a href="corenrn__parameters_8hpp_source.html#l00064">corenrn_parameters.hpp:64</a></div></div>
<div class="ttc" id="anamespacecoreneuron_html_acc57e7378e9558c1e82f3ff872a29b79"><div class="ttname"><a href="namespacecoreneuron.html#acc57e7378e9558c1e82f3ff872a29b79">coreneuron::nrn_soa_padded_size</a></div><div class="ttdeci">int nrn_soa_padded_size(int cnt, int layout)</div><div class="ttdoc">calculate size after padding for specific memory layout</div><div class="ttdef"><b>Definition:</b> <a href="mem__layout__util_8cpp_source.html#l00015">mem_layout_util.cpp:15</a></div></div>
<div class="ttc" id="anamespacecoreneuron_html_a667da2c989834a6e63966c637899c6de"><div class="ttname"><a href="namespacecoreneuron.html#a667da2c989834a6e63966c637899c6de">coreneuron::interleave_permute_type</a></div><div class="ttdeci">int interleave_permute_type</div><div class="ttdef"><b>Definition:</b> <a href="cellorder_8cpp_source.html#l00028">cellorder.cpp:28</a></div></div>
<div class="ttc" id="anamespacecoreneuron_html"><div class="ttname"><a href="namespacecoreneuron.html">coreneuron</a></div><div class="ttdoc">THIS FILE IS AUTO GENERATED DONT MODIFY IT.</div><div class="ttdef"><b>Definition:</b> <a href="corenrn__parameters_8cpp_source.html#l00012">corenrn_parameters.cpp:12</a></div></div>
<div class="ttc" id="atest__solver_8cpp_html_a3cd33a50af827d1a2ee8ca04bd897b35"><div class="ttname"><a href="test__solver_8cpp.html#a3cd33a50af827d1a2ee8ca04bd897b35">compare_solver_data</a></div><div class="ttdeci">void compare_solver_data(std::map&lt; SolverImplementation, std::vector&lt; SolverData &gt;&gt; const &amp;solver_data)</div><div class="ttdef"><b>Definition:</b> <a href="test__solver_8cpp_source.html#l00281">test_solver.cpp:281</a></div></div>
<div class="ttc" id="astruct_solver_data_html_ad56edaf3ee9e0f9c7d951c5318d358b4"><div class="ttname"><a href="struct_solver_data.html#ad56edaf3ee9e0f9c7d951c5318d358b4">SolverData::rhs</a></div><div class="ttdeci">std::vector&lt; double &gt; rhs</div><div class="ttdef"><b>Definition:</b> <a href="test__solver_8cpp_source.html#l00027">test_solver.cpp:27</a></div></div>
<div class="ttc" id="acorenrn__parameters_8hpp_html"><div class="ttname"><a href="corenrn__parameters_8hpp.html">corenrn_parameters.hpp</a></div></div>
<div class="ttc" id="astruct_toy_model_config_html_a1b8aef189e959f5fd99abb738d8ce90a"><div class="ttname"><a href="struct_toy_model_config.html#a1b8aef189e959f5fd99abb738d8ce90a">ToyModelConfig::num_segments_per_cell</a></div><div class="ttdeci">int num_segments_per_cell</div><div class="ttdef"><b>Definition:</b> <a href="test__solver_8cpp_source.html#l00067">test_solver.cpp:67</a></div></div>
<div class="ttc" id="atest__solver_8cpp_html_a332943ed8722a743e7470d684f424ccd"><div class="ttname"><a href="test__solver_8cpp.html#a332943ed8722a743e7470d684f424ccd">random_config</a></div><div class="ttdeci">auto random_config()</div><div class="ttdef"><b>Definition:</b> <a href="test__solver_8cpp_source.html#l00357">test_solver.cpp:357</a></div></div>
<div class="ttc" id="anamespacecoreneuron_html_a0d622e7fc447409d8d9e9e9c0cc887bc"><div class="ttname"><a href="namespacecoreneuron.html#a0d622e7fc447409d8d9e9e9c0cc887bc">coreneuron::destroy_interleave_info</a></div><div class="ttdeci">void destroy_interleave_info()</div><div class="ttdef"><b>Definition:</b> <a href="cellorder_8cpp_source.html#l00101">cellorder.cpp:101</a></div></div>
<div class="ttc" id="astruct_setup_threads_html"><div class="ttname"><a href="struct_setup_threads.html">SetupThreads</a></div><div class="ttdef"><b>Definition:</b> <a href="test__solver_8cpp_source.html#l00075">test_solver.cpp:75</a></div></div>
<div class="ttc" id="anode__permute_8h_html"><div class="ttname"><a href="node__permute_8h.html">node_permute.h</a></div></div>
<div class="ttc" id="astructcoreneuron_1_1_nrn_thread_html"><div class="ttname"><a href="structcoreneuron_1_1_nrn_thread.html">coreneuron::NrnThread</a></div><div class="ttdef"><b>Definition:</b> <a href="multicore_8hpp_source.html#l00075">multicore.hpp:75</a></div></div>
<div class="ttc" id="astruct_solver_data_html"><div class="ttname"><a href="struct_solver_data.html">SolverData</a></div><div class="ttdef"><b>Definition:</b> <a href="test__solver_8cpp_source.html#l00026">test_solver.cpp:26</a></div></div>
<div class="ttc" id="anamespacecoreneuron_html_a46e81f32cfe741466495564aa42ece20"><div class="ttname"><a href="namespacecoreneuron.html#a46e81f32cfe741466495564aa42ece20">coreneuron::permute_ptr</a></div><div class="ttdeci">void permute_ptr(int *vec, int n, int *p)</div><div class="ttdef"><b>Definition:</b> <a href="node__permute_8cpp_source.html#l00345">node_permute.cpp:345</a></div></div>
<div class="ttc" id="atest__solver_8cpp_html_a8397aa081f2b0eebb70b227d2e46412eae644b240b25d52b3f04785717d3e64c4"><div class="ttname"><a href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412eae644b240b25d52b3f04785717d3e64c4">SolverImplementation::CellPermute1_CPU</a></div><div class="ttdeci">@ CellPermute1_CPU</div></div>
<div class="ttc" id="astruct_setup_threads_html_a0832d645de6d50f363d193e6c03ef016"><div class="ttname"><a href="struct_setup_threads.html#a0832d645de6d50f363d193e6c03ef016">SetupThreads::solve</a></div><div class="ttdeci">void solve()</div><div class="ttdef"><b>Definition:</b> <a href="test__solver_8cpp_source.html#l00245">test_solver.cpp:245</a></div></div>
<div class="ttc" id="atest__solver_8cpp_html_a387c28f132c929b444a3008052c15606"><div class="ttname"><a href="test__solver_8cpp.html#a387c28f132c929b444a3008052c15606">active_implementations</a></div><div class="ttdeci">auto active_implementations()</div><div class="ttdef"><b>Definition:</b> <a href="test__solver_8cpp_source.html#l00266">test_solver.cpp:266</a></div></div>
<div class="ttc" id="astructcoreneuron_1_1corenrn__parameters__data_html_a84ebb3fb6afc6d1c28f8181aa4dd394d"><div class="ttname"><a href="structcoreneuron_1_1corenrn__parameters__data.html#a84ebb3fb6afc6d1c28f8181aa4dd394d">coreneuron::corenrn_parameters_data::cuda_interface</a></div><div class="ttdeci">bool cuda_interface</div><div class="ttdoc">Enable GPU computation.</div><div class="ttdef"><b>Definition:</b> <a href="corenrn__parameters_8hpp_source.html#l00065">corenrn_parameters.hpp:65</a></div></div>
<div class="ttc" id="anamespacecoreneuron_html_ab5791af02b3ac68e31ac6640fac4b11d"><div class="ttname"><a href="namespacecoreneuron.html#ab5791af02b3ac68e31ac6640fac4b11d">coreneuron::node_permute</a></div><div class="ttdeci">void node_permute(int *vec, int n, int *permute)</div><div class="ttdef"><b>Definition:</b> <a href="node__permute_8cpp_source.html#l00337">node_permute.cpp:337</a></div></div>
<div class="ttc" id="anamespacecoreneuron_html_aef77588893642107a1b22047c17ea9e1"><div class="ttname"><a href="namespacecoreneuron.html#aef77588893642107a1b22047c17ea9e1">coreneuron::corenrn_param</a></div><div class="ttdeci">corenrn_parameters corenrn_param</div><div class="ttdoc">Printing method.</div><div class="ttdef"><b>Definition:</b> <a href="corenrn__parameters_8cpp_source.html#l00269">corenrn_parameters.cpp:269</a></div></div>
<div class="ttc" id="atest__solver_8cpp_html_a8397aa081f2b0eebb70b227d2e46412eaaadc7fd34604d6205e36e856ae4347cf"><div class="ttname"><a href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412eaaadc7fd34604d6205e36e856ae4347cf">SolverImplementation::CellPermute0_GPU</a></div><div class="ttdeci">@ CellPermute0_GPU</div></div>
<div class="ttc" id="anamespacecoreneuron_html_a004a963731f8a5c295fba256b92c44f1"><div class="ttname"><a href="namespacecoreneuron.html#a004a963731f8a5c295fba256b92c44f1">coreneuron::nrn_threads</a></div><div class="ttdeci">NrnThread * nrn_threads</div><div class="ttdef"><b>Definition:</b> <a href="coreneuron_2sim_2multicore_8cpp_source.html#l00056">multicore.cpp:56</a></div></div>
<div class="ttc" id="anamespacecoreneuron_html_a20e00a6e9ccb99b25b555124b3745ef0"><div class="ttname"><a href="namespacecoreneuron.html#a20e00a6e9ccb99b25b555124b3745ef0">coreneuron::ncell</a></div><div class="ttdeci">icycle&lt; ncycle;++icycle) { int istride=stride[icycle];nrn_pragma_acc(loop vector) nrn_pragma_omp(loop bind(parallel)) for(int icore=0;icore&lt; warpsize;++icore) { int i=ii+icore;if(icore&lt; istride) { int ip=GPU_PARENT(i);GPU_RHS(i) -=GPU_B(i) *GPU_RHS(ip);GPU_RHS(i)/=GPU_D(i);} i+=istride;} ii+=istride;} }}void solve_interleaved2(int ith) { NrnThread *nt=nrn_threads+ith;InterleaveInfo &amp;ii=interleave_info[ith];int nwarp=ii.nwarp;if(nwarp==0) return;int ncore=nwarp *warpsize;int *ncycles=ii.cellsize;int *stridedispl=ii.stridedispl;int *strides=ii.stride;int *rootbegin=ii.firstnode;int *nodebegin=ii.lastnode;if(nt-&gt;compute_gpu) { nrn_pragma_acc(parallel loop gang present(nt[0:1], strides[0:nstride], ncycles[0:nwarp], stridedispl[0:nwarp+1], rootbegin[0:nwarp+1], nodebegin[0:nwarp+1]) async(nt-&gt;stream_id)) nrn_pragma_omp(target teams loop map(present, alloc:nt[:1], strides[:nstride], ncycles[:nwarp], stridedispl[:nwarp+1], rootbegin[:nwarp+1], nodebegin[:nwarp+1])) for(int icore=0;icore&lt; ncore;icore+=warpsize) { solve_interleaved2_loop_body(nt, icore, ncycles, strides, stridedispl, rootbegin, nodebegin);} nrn_pragma_acc(wait(nt-&gt;stream_id)) } else { for(int icore=0;icore&lt; ncore;icore+=warpsize) { solve_interleaved2_loop_body(nt, icore, ncycles, strides, stridedispl, rootbegin, nodebegin);} }}void solve_interleaved1(int ith) { NrnThread *nt=nrn_threads+ith;int ncell=nt-&gt; ncell</div><div class="ttdef"><b>Definition:</b> <a href="cellorder_8cpp_source.html#l00647">cellorder.cpp:647</a></div></div>
<div class="ttc" id="atest__solver_8cpp_html_a4d98aee818f565cdc2971aeeb3157178"><div class="ttname"><a href="test__solver_8cpp.html#a4d98aee818f565cdc2971aeeb3157178">magic_double_value</a></div><div class="ttdeci">constexpr auto magic_double_value</div><div class="ttdef"><b>Definition:</b> <a href="test__solver_8cpp_source.html#l00032">test_solver.cpp:32</a></div></div>
<div class="ttc" id="astruct_setup_threads_html_aef1ce15f5e675e79acac564c0c5a8aa0"><div class="ttname"><a href="struct_setup_threads.html#aef1ce15f5e675e79acac564c0c5a8aa0">SetupThreads::dump_solver_data</a></div><div class="ttdeci">auto dump_solver_data()</div><div class="ttdef"><b>Definition:</b> <a href="test__solver_8cpp_source.html#l00209">test_solver.cpp:209</a></div></div>
<div class="ttc" id="atest__solver_8cpp_html_afa624dd14df4686b7bbd81d28ff731fb"><div class="ttname"><a href="test__solver_8cpp.html#afa624dd14df4686b7bbd81d28ff731fb">default_tolerance</a></div><div class="ttdeci">constexpr double default_tolerance</div><div class="ttdef"><b>Definition:</b> <a href="test__solver_8cpp_source.html#l00317">test_solver.cpp:317</a></div></div>
<div class="ttc" id="aredef_8h_html_ae7b1d18a435dcca5e1837205e5fc909d"><div class="ttname"><a href="redef_8h.html#ae7b1d18a435dcca5e1837205e5fc909d">ret</a></div><div class="ttdeci">#define ret</div><div class="ttdef"><b>Definition:</b> <a href="redef_8h_source.html#l00116">redef.h:116</a></div></div>
<div class="ttc" id="acellorder_8hpp_html"><div class="ttname"><a href="cellorder_8hpp.html">cellorder.hpp</a></div></div>
<div class="ttc" id="atest__solver_8cpp_html_a8397aa081f2b0eebb70b227d2e46412ea8c346d0cf6d2edf77f427f5c40b97fe8"><div class="ttname"><a href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412ea8c346d0cf6d2edf77f427f5c40b97fe8">SolverImplementation::CellPermute0_CPU</a></div><div class="ttdeci">@ CellPermute0_CPU</div></div>
<div class="ttc" id="astruct_setup_threads_html_a01ce4e92e6e661c38ea79383308d7107"><div class="ttname"><a href="struct_setup_threads.html#a01ce4e92e6e661c38ea79383308d7107">SetupThreads::SetupThreads</a></div><div class="ttdeci">SetupThreads(SolverImplementation impl, ToyModelConfig config={})</div><div class="ttdef"><b>Definition:</b> <a href="test__solver_8cpp_source.html#l00076">test_solver.cpp:76</a></div></div>
<div class="ttc" id="anamespacecoreneuron_html_aa128e53f31aa5d4fda7a72f7d375df6c"><div class="ttname"><a href="namespacecoreneuron.html#aa128e53f31aa5d4fda7a72f7d375df6c">coreneuron::inverse_permute</a></div><div class="ttdeci">int * inverse_permute(int *p, int n)</div><div class="ttdef"><b>Definition:</b> <a href="node__permute_8cpp_source.html#l00131">node_permute.cpp:131</a></div></div>
<div class="ttc" id="anamespacecoreneuron_html_a6ef5948277937e3ec68daddde65f7e6f"><div class="ttname"><a href="namespacecoreneuron.html#a6ef5948277937e3ec68daddde65f7e6f">coreneuron::use_solve_interleave</a></div><div class="ttdeci">bool use_solve_interleave</div><div class="ttdef"><b>Definition:</b> <a href="solve__core_8cpp_source.html#l00013">solve_core.cpp:13</a></div></div>
<div class="ttc" id="amulticore_8hpp_html"><div class="ttname"><a href="multicore_8hpp.html">multicore.hpp</a></div></div>
<div class="ttc" id="anamespacecoreneuron_html_a149fe28c5313b095e5907169454137fd"><div class="ttname"><a href="namespacecoreneuron.html#a149fe28c5313b095e5907169454137fd">coreneuron::create_interleave_info</a></div><div class="ttdeci">void create_interleave_info()</div><div class="ttdef"><b>Definition:</b> <a href="cellorder_8cpp_source.html#l00096">cellorder.cpp:96</a></div></div>
<div class="ttc" id="atest__solver_8cpp_html_a70b83806565dfb8c29aeb03236ef459b"><div class="ttname"><a href="test__solver_8cpp.html#a70b83806565dfb8c29aeb03236ef459b">compare_all_active_implementations</a></div><div class="ttdeci">auto compare_all_active_implementations(Args &amp;&amp;... args)</div><div class="ttdef"><b>Definition:</b> <a href="test__solver_8cpp_source.html#l00306">test_solver.cpp:306</a></div></div>
<div class="ttc" id="anamespacecoreneuron_html_a1769af4eb2a7586cfd493c99f3d59a67"><div class="ttname"><a href="namespacecoreneuron.html#a1769af4eb2a7586cfd493c99f3d59a67">coreneuron::emalloc_align</a></div><div class="ttdeci">void * emalloc_align(size_t size, size_t alignment)</div></div>
<div class="ttc" id="astruct_setup_threads_html_a6dc8592dcca5239513a96a9155ca53d9"><div class="ttname"><a href="struct_setup_threads.html#a6dc8592dcca5239513a96a9155ca53d9">SetupThreads::~SetupThreads</a></div><div class="ttdeci">~SetupThreads()</div><div class="ttdef"><b>Definition:</b> <a href="test__solver_8cpp_source.html#l00196">test_solver.cpp:196</a></div></div>
<div class="ttc" id="atest__solver_8cpp_html_a8397aa081f2b0eebb70b227d2e46412e"><div class="ttname"><a href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412e">SolverImplementation</a></div><div class="ttdeci">SolverImplementation</div><div class="ttdef"><b>Definition:</b> <a href="test__solver_8cpp_source.html#l00034">test_solver.cpp:34</a></div></div>
<div class="ttc" id="atest__solver_8cpp_html_a706e782afe803bc26f5e19d7f158e575"><div class="ttname"><a href="test__solver_8cpp.html#a706e782afe803bc26f5e19d7f158e575">TEST_CASE</a></div><div class="ttdeci">TEST_CASE(&quot;SingleCellAndThread&quot;, &quot;[solver][single-thread]&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="test__solver_8cpp_source.html#l00319">test_solver.cpp:319</a></div></div>
<div class="ttc" id="astruct_setup_threads_html_a0b6d00fc61f0bd86bbbedc57309314f9"><div class="ttname"><a href="struct_setup_threads.html#a0b6d00fc61f0bd86bbbedc57309314f9">SetupThreads::begin</a></div><div class="ttdeci">NrnThread * begin() const</div><div class="ttdef"><b>Definition:</b> <a href="test__solver_8cpp_source.html#l00251">test_solver.cpp:251</a></div></div>
<div class="ttc" id="atest__solver_8cpp_html_a8397aa081f2b0eebb70b227d2e46412ea970e14a39e275541316b0386b965483c"><div class="ttname"><a href="test__solver_8cpp.html#a8397aa081f2b0eebb70b227d2e46412ea970e14a39e275541316b0386b965483c">SolverImplementation::CellPermute1_GPU</a></div><div class="ttdeci">@ CellPermute1_GPU</div></div>
<div class="ttc" id="alineq_8h_html_a1939c197093fe6b7fa35494fd046328d"><div class="ttname"><a href="lineq_8h.html#a1939c197093fe6b7fa35494fd046328d">rhs</a></div><div class="ttdeci">#define rhs</div><div class="ttdef"><b>Definition:</b> <a href="lineq_8h_source.html#l00006">lineq.h:6</a></div></div>
<div class="ttc" id="astruct_toy_model_config_html"><div class="ttname"><a href="struct_toy_model_config.html">ToyModelConfig</a></div><div class="ttdef"><b>Definition:</b> <a href="test__solver_8cpp_source.html#l00064">test_solver.cpp:64</a></div></div>
<div class="ttc" id="astructcoreneuron_1_1_nrn_thread_html_a6d0c441ef118780fbbe626fd027ae963"><div class="ttname"><a href="structcoreneuron_1_1_nrn_thread.html#a6d0c441ef118780fbbe626fd027ae963">coreneuron::NrnThread::ncell</a></div><div class="ttdeci">int ncell</div><div class="ttdef"><b>Definition:</b> <a href="multicore_8hpp_source.html#l00097">multicore.hpp:97</a></div></div>
<div class="ttc" id="anamespacecoreneuron_html_af3186bb62f5703fe61cd8005741c11f9"><div class="ttname"><a href="namespacecoreneuron.html#af3186bb62f5703fe61cd8005741c11f9">coreneuron::operator&lt;&lt;</a></div><div class="ttdeci">std::ostream &amp; operator&lt;&lt;(std::ostream &amp;os, const corenrn_parameters &amp;corenrn_param)</div><div class="ttdef"><b>Definition:</b> <a href="corenrn__parameters_8cpp_source.html#l00219">corenrn_parameters.cpp:219</a></div></div>
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<div id="nav-path" class="navpath">
  <ul>
    <li class="navelem"><a class="el" href="dir_13e138d54eb8818da29c3992edef070a.html">test</a></li><li class="navelem"><a class="el" href="dir_63ccae4159b9ae86e96b00a67a71c9f0.html">coreneuron</a></li><li class="navelem"><a class="el" href="dir_551395b73e3d9d18f4b3bc72c86e4c67.html">unit</a></li><li class="navelem"><a class="el" href="dir_78c241d8809959cb2af9266aaac3dc96.html">solver</a></li><li class="navelem"><a class="el" href="test__solver_8cpp.html">test_solver.cpp</a></li>
  </ul>
</div>
<hr class="footer"/>
<address class="footer">
    <small>
    </small>
</address>
<!--END !GENERATE_TREEVIEW-->
</body>
</html>
